<?xml version="1.0" encoding="utf-8"?>
<sqltoy xmlns="http://www.sagframe.com/schema/sqltoy"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.sagframe.com/schema/sqltoy http://www.sagframe.com/schema/sqltoy/sqltoy.xsd">

    <!-- 根据实体参数获取查询菜单 -->
    <sql id="system_menu_findByEntityParam">
        <value>
            <![CDATA[
                SELECT
                	sys_menu.ID,
                	sys_menu.MENU_NAME,
                	sys_menu.PERMISSION_CODE,
                	sys_menu.ROUTER_PATH,
                	sys_menu.PARENT_ID,
                	sys_menu.MENU_TYPE,
                	sys_menu.IS_MENU,
                	sys_menu.SORT,
                	sys_menu.COMPONENT_PATH,
                	sys_menu.IS_EXTERNAL_LINK,
                	sys_menu.ICON_PATH
                FROM
                	sys_menu
                WHERE
                	#[and IS_MENU = :isMenu]
                	and DELETE_STATUS = 1
                ORDER BY SORT
			]]>
        </value>
    </sql>

    <!-- 查询用户的权限，参数为用户id -->
    <sql id="system_menu_findUserPermission">
        <value>
            <![CDATA[
                SELECT
                	sys_menu.ID,
                	sys_menu.MENU_NAME,
                	sys_menu.PERMISSION_CODE,
                	sys_menu.ROUTER_PATH,
                	sys_menu.PARENT_ID,
                	sys_menu.MENU_TYPE,
                	sys_menu.IS_MENU,
                	sys_menu.SORT,
                	sys_menu.COMPONENT_PATH,
                	sys_menu.IS_EXTERNAL_LINK,
                	sys_menu.ICON_PATH
                from sys_menu
                where ID in
                      (select MENU_ID from sys_role_menu where ROLE_ID in (select ROLE_ID from sys_user_role where USER_ID = :userId))
                  and DELETE_STATUS = 1
            ]]>
        </value>
    </sql>
</sqltoy>